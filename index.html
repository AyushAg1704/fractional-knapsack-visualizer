<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fractional Knapsack Visualizer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: #e2e8f0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #60a5fa;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #94a3b8;
            margin-bottom: 30px;
        }

        .steps-section {
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .steps-section h2 {
            color: #60a5fa;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .steps-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .step-item {
            background: #0f172a;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #60a5fa;
        }

        .step-number {
            font-weight: bold;
            color: #60a5fa;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .controls-section {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .control-panel, .status-panel {
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .control-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #94a3b8;
            font-weight: 500;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #334155;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #60a5fa;
            cursor: pointer;
        }

        .buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 100px;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #475569;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #334155;
        }

        .btn-success {
            background: #22c55e;
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            background: #16a34a;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .status-card {
            background: #0f172a;
            padding: 20px;
            border-radius: 8px;
        }

        .status-label {
            color: #94a3b8;
            font-size: 0.9em;
            margin-bottom: 8px;
        }

        .status-value {
            font-size: 2em;
            font-weight: bold;
            color: #60a5fa;
        }

        .status-value.green {
            color: #22c55e;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #334155;
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            transition: width 0.5s ease;
            border-radius: 6px;
        }

        .table-section {
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #0f172a;
            padding: 15px;
            text-align: left;
            color: #60a5fa;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #334155;
        }

        tr:hover {
            background: #334155;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px;
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 4px;
            color: #e2e8f0;
            font-size: 0.9em;
        }

        input[type="text"]:focus, input[type="number"]:focus {
            outline: none;
            border-color: #60a5fa;
        }

        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-gray {
            background: #334155;
            color: #94a3b8;
        }

        .badge-green {
            background: #065f46;
            color: #6ee7b7;
        }

        .badge-yellow {
            background: #713f12;
            color: #fde047;
        }

        .delete-btn {
            background: #dc2626;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 0.9em;
        }

        .delete-btn:hover:not(:disabled) {
            background: #b91c1c;
        }

        .chart-section {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .chart-section h2 {
            color: #1e293b;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .capacity-display {
            font-size: 1.1em;
            margin-top: 5px;
            color: #60a5fa;
        }

        .capacity-remaining {
            font-size: 1.5em;
            font-weight: bold;
            color: #fbbf24;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéí Fractional Knapsack Algorithm</h1>
        <p class="subtitle">Greedy approach: selecting items by highest value-to-weight ratio first</p>

        <div class="steps-section">
            <h2>üìã How It Works</h2>
            <div class="steps-list">
                <div class="step-item">
                    <div class="step-number">Step 1: Calculate Ratios</div>
                    <div>Compute value/weight ratio for each item to determine efficiency</div>
                </div>
                <div class="step-item">
                    <div class="step-number">Step 2: Sort Items</div>
                    <div>Sort all items by their ratio in descending order (highest first)</div>
                </div>
                <div class="step-item">
                    <div class="step-number">Step 3: Fill Knapsack</div>
                    <div>Take items greedily starting with highest ratio until capacity is full</div>
                </div>
                <div class="step-item">
                    <div class="step-number">Step 4: Fractional Taking</div>
                    <div>If item doesn't fit completely, take fractional part to fill remaining capacity</div>
                </div>
            </div>
        </div>

        <div class="controls-section">
            <div class="control-panel">
                <h2>üéõÔ∏è Controls</h2>
                <div class="control-group">
                    <label>Knapsack Capacity:</label>
                    <input type="number" id="capacityInput" min="1" max="1000" value="50" style="padding: 10px; font-size: 1.1em; font-weight: bold;">
                </div>
                <div class="buttons">
                    <button class="btn-primary" id="startBtn">‚ñ∂ Start</button>
                    <button class="btn-secondary" id="resetBtn">‚Üª Reset</button>
                    <button class="btn-success" id="addBtn">+ Add Item</button>
                </div>
            </div>

            <div class="status-panel">
                <h2>üìä Status</h2>
                <div class="status-grid">
                    <div class="status-card">
                        <div class="status-label">Remaining Capacity</div>
                        <div class="status-value capacity-remaining" id="remainingCapacity">50</div>
                        <div class="status-label">Used: <span id="usedCapacity">0</span> / <span id="totalCapacity">50</span></div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="capacityProgress"></div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-label">Total Value</div>
                        <div class="status-value green" id="totalValue">0.00</div>
                        <div class="status-label">Step: <span id="currentStep">0</span> / <span id="totalSteps">4</span></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="table-section">
            <h2>üì¶ Items (Click to Edit)</h2>
            <table id="itemsTable">
                <thead>
                    <tr>
                        <th>Item Name</th>
                        <th>Weight</th>
                        <th>Value</th>
                        <th>Ratio (V/W)</th>
                        <th>Taken</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="itemsBody">
                </tbody>
            </table>
        </div>

        <div class="chart-section">
            <h2>Items by Value-to-Weight Ratio</h2>
            <canvas id="ratioChart"></canvas>
        </div>
    </div>

    <script>
        let items = [
            { id: 1, name: 'Item A', weight: 10, value: 60, ratio: 6, taken: 0 },
            { id: 2, name: 'Item B', weight: 20, value: 100, ratio: 5, taken: 0 },
            { id: 3, name: 'Item C', weight: 30, value: 120, ratio: 4, taken: 0 },
            { id: 4, name: 'Item D', weight: 15, value: 75, ratio: 5, taken: 0 }
        ];

        let capacity = 50;
        let currentCapacity = 0;
        let isAnimating = false;
        let currentStep = 0;
        let totalValue = 0;
        let chart = null;

        const capacityInput = document.getElementById('capacityInput');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const addBtn = document.getElementById('addBtn');
        const itemsBody = document.getElementById('itemsBody');

        function updateCapacityDisplay() {
            const remaining = capacity - currentCapacity;
            document.getElementById('remainingCapacity').textContent = remaining.toFixed(1);
            document.getElementById('usedCapacity').textContent = currentCapacity.toFixed(1);
            document.getElementById('totalCapacity').textContent = capacity;
            document.getElementById('capacityProgress').style.width = `${(currentCapacity / capacity) * 100}%`;
        }

        function calculateRatio(item) {
            return item.value / item.weight;
        }

        function updateItem(id, field, value) {
            const item = items.find(i => i.id === id);
            if (!item) return;

            if (field === 'weight' || field === 'value') {
                value = parseFloat(value) || 0;
                if (value <= 0) value = 1;
            }

            item[field] = value;
            
            if (field === 'weight' || field === 'value') {
                item.ratio = calculateRatio(item);
            }

            resetSimulation();
            renderTable();
            updateChart();
        }

        function renderTable() {
            const sortedItems = [...items].sort((a, b) => b.ratio - a.ratio);
            itemsBody.innerHTML = '';

            sortedItems.forEach(item => {
                const row = document.createElement('tr');
                
                let badgeClass = 'badge-gray';
                let takenText = '0%';
                if (item.taken > 0) {
                    badgeClass = item.taken === 1 ? 'badge-green' : 'badge-yellow';
                    takenText = `${(item.taken * 100).toFixed(0)}%`;
                }

                row.innerHTML = `
                    <td><input type="text" value="${item.name}" onchange="updateItem(${item.id}, 'name', this.value)"></td>
                    <td><input type="number" value="${item.weight}" min="1" onchange="updateItem(${item.id}, 'weight', this.value)"></td>
                    <td><input type="number" value="${item.value}" min="1" onchange="updateItem(${item.id}, 'value', this.value)"></td>
                    <td><strong style="color: #60a5fa;">${item.ratio.toFixed(2)}</strong></td>
                    <td><span class="badge ${badgeClass}">${takenText}</span></td>
                    <td><button class="delete-btn" onclick="removeItem(${item.id})" ${items.length <= 1 || isAnimating ? 'disabled' : ''}>Delete</button></td>
                `;
                itemsBody.appendChild(row);
            });

            document.getElementById('totalSteps').textContent = items.length;
        }

        function updateChart() {
            const sortedItems = [...items].sort((a, b) => b.ratio - a.ratio);
            const labels = sortedItems.map(item => item.name);
            const ratioData = sortedItems.map(item => item.ratio);
            
            const colors = sortedItems.map(item => {
                if (item.taken === 0) return '#64748b';
                if (item.taken === 1) return '#22c55e';
                return '#eab308';
            });

            if (chart) {
                chart.data.labels = labels;
                chart.data.datasets[0].data = ratioData;
                chart.data.datasets[0].backgroundColor = colors;
                chart.update();
            } else {
                const ctx = document.getElementById('ratioChart').getContext('2d');
                chart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Value/Weight Ratio',
                            data: ratioData,
                            backgroundColor: colors,
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: { 
                                labels: { 
                                    color: '#1e293b',
                                    font: { size: 12 }
                                },
                                position: 'bottom'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: { 
                                    color: '#64748b',
                                    font: { size: 11 }
                                },
                                grid: { 
                                    color: '#e2e8f0',
                                    drawBorder: false
                                }
                            },
                            x: {
                                ticks: { 
                                    color: '#64748b',
                                    font: { size: 11 }
                                },
                                grid: { 
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
        }

        function resetSimulation() {
            isAnimating = false;
            currentStep = 0;
            currentCapacity = 0;
            totalValue = 0;
            items.forEach(item => item.taken = 0);
            
            document.getElementById('totalValue').textContent = '0.00';
            document.getElementById('currentStep').textContent = '0';
            startBtn.textContent = '‚ñ∂ Start';
            startBtn.disabled = false;
            
            updateCapacityDisplay();
            renderTable();
            updateChart();
        }

        function animateStep() {
            if (!isAnimating) return;

            const sortedItems = [...items].sort((a, b) => b.ratio - a.ratio);
            
            if (currentStep >= sortedItems.length) {
                isAnimating = false;
                startBtn.textContent = '‚ñ∂ Start';
                return;
            }

            const currentItem = sortedItems[currentStep];
            const remainingCapacity = capacity - currentCapacity;
            
            if (remainingCapacity <= 0) {
                isAnimating = false;
                startBtn.textContent = '‚ñ∂ Start';
                return;
            }

            const amountToTake = Math.min(currentItem.weight, remainingCapacity);
            const fraction = amountToTake / currentItem.weight;
            
            currentItem.taken = fraction;
            currentCapacity += amountToTake;
            totalValue += currentItem.value * fraction;
            currentStep++;

            document.getElementById('totalValue').textContent = totalValue.toFixed(2);
            document.getElementById('currentStep').textContent = currentStep;
            
            updateCapacityDisplay();
            renderTable();
            updateChart();

            setTimeout(animateStep, 1000);
        }

        function addItem() {
            const newId = Math.max(...items.map(i => i.id), 0) + 1;
            const weight = Math.floor(Math.random() * 30) + 5;
            const value = Math.floor(Math.random() * 100) + 20;
            items.push({
                id: newId,
                name: `Item ${String.fromCharCode(64 + newId)}`,
                weight: weight,
                value: value,
                ratio: value / weight,
                taken: 0
            });
            resetSimulation();
        }

        function removeItem(id) {
            if (items.length > 1 && !isAnimating) {
                items = items.filter(item => item.id !== id);
                resetSimulation();
            }
        }

        capacityInput.addEventListener('input', (e) => {
            let newCapacity = parseInt(e.target.value);
            if (newCapacity < 1) newCapacity = 1;
            if (newCapacity > 1000) newCapacity = 1000;
            capacity = newCapacity;
            e.target.value = newCapacity;
            resetSimulation();
        });

        startBtn.addEventListener('click', () => {
            if (isAnimating) {
                isAnimating = false;
                startBtn.textContent = '‚ñ∂ Start';
            } else {
                isAnimating = true;
                startBtn.textContent = '‚è∏ Pause';
                animateStep();
            }
        });

        resetBtn.addEventListener('click', resetSimulation);
        addBtn.addEventListener('click', addItem);

        updateCapacityDisplay();
        renderTable();
        updateChart();
    </script>
</body>
</html>